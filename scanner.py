import requests
from bs4 import BeautifulSoup
import subprocess

# Function to scan a website and find all links
def scan_website(url):
    try:
        response = requests.get(url)
        if response.status_code == 200:
            soup = BeautifulSoup(response.text, 'html.parser')
            links = []
            for anchor in soup.find_all('a'):
                link = anchor.get('href')
                if link:
                    links.append(link)
            return links
        else:
            print(f"Failed to retrieve {url}. Status code: {response.status_code}")
    except requests.exceptions.RequestException as e:
        print(f"An error occurred: {e}")
    
# Function to scan a URL for malware using ClamAV
def scan_for_malware(url):
    try:
        response = requests.get(url)
        if response.status_code == 200:
            content = response.content
            with open('temp_file', 'wb') as temp_file:
                temp_file.write(content)
            result = subprocess.run(['clamscan', 'temp_file'], stdout=subprocess.PIPE, stderr=subprocess.PIPE, universal_newlines=True)
            if "Infected files: 0" in result.stdout:
                print(f"No malware found on {url}")
            else:
                print(f"Malware found on {url}:\n{result.stdout}")
        else:
            print(f"Failed to retrieve {url}. Status code: {response.status_code}")
    except requests.exceptions.RequestException as e:
        print(f"An error occurred: {e}")

# Function to check for common configuration files
def check_for_config_files(url):
    common_config_files = [
        "robots.txt",
        ".htaccess",
        "wp-config.php",
        "config.php",
        "web.config",
    ]
    for file in common_config_files:
        config_url = f"{url}/{file}"
        response = requests.get(config_url)
        if response.status_code == 200:
            print(f"Found a potentially sensitive configuration file: {config_url}")

if __name__ == '__main__':
    website_url = input("Enter the website URL to scan: ")
    links = scan_website(website_url)
    
    if links:
        print(f"Links found on {website_url}:\n")
        for link in links:
            print(link)
        
        print("\nScanning for malware...\n")
        scan_for_malware(website_url)

        print("\nChecking for common configuration files...\n")
        check_for_config_files(website_url)
    else:
        print(f"No links found on {website_url}")
